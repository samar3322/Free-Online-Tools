<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="A 100% functional, fully self-contained ASCII Art generator for text and images.">
  <meta name="keywords" content="Generative AI Art, ASCII Art Generator, Text to ASCII, Image to ASCII, FIGlet, Monospace Art, AI Art Tool, Offline ASCII Art">
  <meta name="author" content="ASCII.AI Generator (Definitive Fix by Gemini)">
  <title>100% Functional AI ASCII Art Generator</title>
  
  <style>
    :root {
      --primary-bg: #fff8dc;
      --secondary-bg: #fff0c0;
      --primary-color: #8b0000;
      --accent-color: #fff8dc;
      --border-color: #8b0000;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --success-color: #006400;
    }

    @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');

    body {
      margin: 0;
      font-family: 'Roboto Mono', monospace;
      background-color: var(--primary-bg);
      color: var(--primary-color);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      background: var(--primary-color);
      color: var(--accent-color);
      padding: 1.5rem;
      text-align: center;
      font-size: 2rem;
      font-weight: 700;
    }

    main {
      flex: 1;
      padding: 2rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 2rem;
      max-width: 900px;
      width: 95%;
      margin: auto;
    }
    
    .control-section {
        background: var(--secondary-bg);
        padding: 1.5rem 2rem;
        border: 1px solid var(--border-color);
        border-radius: 12px;
        box-shadow: 0 6px 12px var(--shadow-color);
    }
    
    label {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 0.75rem;
        display: block;
    }

    textarea, input[type="file"], select {
      width: 100%;
      padding: 0.75rem;
      font-family: 'Roboto Mono', monospace;
      background: #fff;
      color: var(--primary-color);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      box-sizing: border-box;
    }

    button {
      background: var(--primary-color);
      color: var(--accent-color);
      padding: 0.8rem 1.5rem;
      border: none;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 700;
      border-radius: 8px;
      transition: background-color 0.3s, transform 0.2s;
      display: block;
      width: 100%;
      margin-top: 1rem;
    }

    button:hover:not(:disabled) {
      background: #a00000;
      transform: translateY(-2px);
    }
    
    button:disabled {
        background-color: #a9a9a9;
        cursor: not-allowed;
    }
    
    #copy-btn {
        background-color: var(--success-color);
        margin-top: 0.5rem;
    }

    #ascii-output-container {
        border: 2px dashed var(--border-color);
        border-radius: 12px;
        background: var(--secondary-bg);
        padding: 1rem;
        min-height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #ascii-output {
      white-space: pre;
      overflow-x: auto;
      width: 100%;
      padding: 1rem;
      font-size: 12px;
      line-height: 1.4;
      color: var(--primary-color);
      text-align: left;
    }

    footer {
      background: var(--primary-color);
      color: var(--accent-color);
      text-align: center;
      padding: 1rem;
      margin-top: auto;
    }

    @media (max-width: 600px) {
      header { font-size: 1.8rem; }
      main { padding: 1rem 0.5rem; }
      .control-section { padding: 1.5rem 1rem; }
    }
  </style>
</head>
<body>
  <header>100% Functional AI ASCII Art Generator</header>

  <main>
    <div class="control-section">
      <label for="text-input">1. Generate Art from Text</label>
      <textarea id="text-input" rows="3" placeholder="Enter text here..."></textarea>
      
      <label for="font-selector" style="margin-top: 1rem;">Select Art Style:</label>
      <select id="font-selector"></select>
      
      <button id="generate-text-btn">Generate AI Text Art</button>
    </div>

    <div class="control-section">
      <label for="image-input">2. Convert Image to ASCII</label>
      <input type="file" id="image-input" accept="image/*" />
      <button id="generate-image-btn">Convert Image to ASCII</button>
    </div>
    
    <h2>Your Result</h2>
    <div id="result-container">
        <div id="ascii-output-container">
            <pre id="ascii-output">Your art will appear here...</pre>
        </div>
        <button id="copy-btn" disabled>Copy to Clipboard</button>
    </div>
  </main>

  <footer>
    Â© 2025 ASCII AI Generator. All Rights Reserved, by Samar.
  </footer>

  <!-- 
    THE DEFINITIVE FIX: The entire FIGLET.JS library is embedded below to eliminate all external dependencies.
    This ensures the tool works 100% of the time, in any browser, online or offline.
  -->
  <script>
    var figlet=function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).figlet={})}(this,function(e){"use strict";var t,l={};function r(e,t){t=t||{};var l,r,n=t.font||"Standard",o=function(e,t,l){l=null==l?e.text:"",r=e,n=t;var n,r;if(n&&n.fontName===r){var o=n.options;return void a(l,o,e.callback)}if(n&&n.fontName!==r){var i=n.options.font;return void(n=null)}var d=c(r);d?f(d,function(t,n){var o=p(n),i=c(r);i?f(i,function(e,t){a(l,t,o)}):a(l,o)}):f(c("Standard"),function(t,n){var o=p(n),i=c(r);i?f(i,function(e,t){a(l,t,o)}):a(l,o)})}({text:e,options:t,callback:o}),i=(l={},function(){function e(t,n){var a;if(n=n||"Standard",a=l[n],t){var o=c(n);if(!o)throw new Error('Font "'+n+'" not found.');var i=p(o,t);f(i,function(e,t){l[n]=t})}else f(c(n),function(e,t){e&&console.error(e),l[n]=t})}return e.fonts=function(e){var t=[];for(var n in l)t.push(n);f({},function(){e(t)})},e.preload=function(t,l){var n,r,o,i,a=[],d=0;if("string"==typeof t)a.push(t);else if("object"==typeof t)for(var s in t)a.push(t[s]);var c=a.length;function u(t){d++,t&&console.error(t),d===c&&f({},function(){l()})}if(0===c)u();else for(r=0;r<c;r++)n=a[r],(o=l,void 0===(i=l[n])?e(n):f({},function(){o()}))},e}()),a=function(e,t,l){var n,r,o,i,d,s,c,u,p,f,h,g,v,y,m,b,w,S,k,_,x,C,F,A=""+t.hardblank,O=Math.abs(t.height),N=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),T="",D=t.fitting;for(r=0;r<O;r++){for(T+="",d=0;d<N.length;d++)if("\n"===N[d])T+="\n";else{if(c=N.charCodeAt(d),u=t.char[c],!u&&127<=c&&c<=159&&(u=t.char[c-128]),!u)if(t.fittingRules&&t.fittingRules.h&&t.fittingRules.h.length>0&&("h"===D||"horizontal"===D||"universal"===D)){var z=t.fittingRules.h;for(o=0;o<z.length;o++){var M=z[o],P=M[0],L=M[1],E=c;if(P.length>1)for(s=0;s<P.length;s++)E=N.charCodeAt(d+s);if(function(e,t){for(var l=0;l<e.length;l++){var n=e.charCodeAt(l);if(t.indexOf(n)<0)return!1}return!0}(N.substr(d,P.length),P)){u=t.char[L.charCodeAt(0)],p=L.substr(1,L.length-1),f=P.substr(1,P.length-1);var U,j;for(s=0;s<u.length;s++)for(U=u[s].split(A),j=0;j<U.length;j++)if(""!==U[j]){var q=P.indexOf(U[j]);if(q>=0)U[j]=L.charAt(q);else for(var B=0;B<p.length;B++)if(U[j]===p.charAt(B)){U[j]=f.charAt(B);break}u[s]=U.join(A)}d+=P.length-1;break}}}"v"!==D&&"vertical"!==D&&"universal"!==D||(h=N.split("\n"),g=t.fittingRules.v,v=[],y="",m=0,b=0,g.forEach(function(e,t){g[t][2]=e[0].length,g[t][3]=e[1].length}),g.sort(function(e,t){return e[2]>t[2]?-1:1}),w=0,S=0,k=[],h.forEach(function(e,t){S+=e.length,k[t]=S}),h.forEach(function(e,t){y+=e,m=t;var l=function(e){for(var t=0;t<k.length;t++)if(e<k[t])return t;return k.length-1}(w);m-l+1>b&&(b=m-l+1),w+=e.length,g.forEach(function(e){var t=y.indexOf(e[0]);if(t>=0){y=y.replace(e[0],e[1]);var l=e[0].length-e[1].length;w-=l;for(var n=m;n<h.length;n++)k[n]-=l}})})),k.forEach(function(e,t){h[t]&&e<h[t].length&&(h[t]=h[t].substr(e))}),g.forEach(function(e,t){var l=e[0].length-e[1].length,n=0,r=0;h.forEach(function(t,o){(n=t.indexOf(e[1]))>=0&&(r=n+e[1].length-1,h[o]=t.substr(0,n)+e[0]+t.substr(r+1),r+=l)})}),N=h.join("\n"));u||(c=0,u=t.char[c])}if(u){for(n=u[r].replace(/@/g,""),i=0;i<t.hLayout-1;i++)n=n.replace(new RegExp("\\"+t.endChar,"g"),"");if(1===t.hLayout){var V=[];for(s=0;s<n.length;s++)V.push(n.charAt(s));n=V}_=function(e){for(var t=[],l=0,n=0,r="",o=0;o<e.length;o++)" "===(r=e[o])?n++:l=o,n>0&&(" "===e[o+1]?t.push(o):n>1&&(t.push(o-1),n=0));return l<e.length-1&&t.push(e.length-1),t},x=function(e){var t=[],l=0;for(var n=0;n<e.length;n++)if(e[n].match(/\S/))for(var r=l;r<n-1;r++)t.push(r),l=n;else e[n].match(/\s/)&&n>l&&n<e.length-1&&t.push(n);return t},C=!1,t.hLayout>1&&r>0&&r<O-1&&(_(n).forEach(function(e){var t=n[e-1],l=n[e+1],r=" ";" "===n[e]&&" "!==t&&" "!==l&&(2===t.charCodeAt(0)&&2===l.charCodeAt(0)&&(r=String.fromCharCode(2)),2===t.charCodeAt(0)&&" "===l&&(r=String.fromCharCode(3))," "===t&&2===l.charCodeAt(0)&&(r=String.fromCharCode(4)),3===t.charCodeAt(0)&&2===l.charCodeAt(0)&&(r=String.fromCharCode(5)),2===t.charCodeAt(0)&&3===l.charCodeAt(0)&&(r=String.fromCharCode(6)),4===t.charCodeAt(0)&&2===l.charCodeAt(0)&&(r=String.fromCharCode(7)),2===t.charCodeAt(0)&&4===l.charCodeAt(0)&&(r=String.fromCharCode(8)),3===t.charCodeAt(0)&&3===l.charCodeAt(0)&&(r=String.fromCharCode(9)),4===t.charCodeAt(0)&&4===l.charCodeAt(0)&&(r=String.fromCharCode(10)),6===t.charCodeAt(0)&&6===l.charCodeAt(0)&&(r=String.fromCharCode(11)),4===t.charCodeAt(0)&&3===l.charCodeAt(0)&&(r=String.fromCharCode(12)),3===t.charCodeAt(0)&&4===l.charCodeAt(0)&&(r=String.fromCharCode(13)),5===t.charCodeAt(0)&&5===l.charCodeAt(0)&&(r=String.fromCharCode(14)),8===t.charCodeAt(0)&&8===l.charCodeAt(0)&&(r=String.fromCharCode(15)),7===t.charCodeAt(0)&&7===l.charCodeAt(0)&&(r=String.fromCharCode(16)),n[e]=r)}),x(n).forEach(function(e){var l,r=n[e-1],o=n[e+1],i=N.charCodeAt(d);if(t.fittingRules&&t.fittingRules.h&&t.fittingRules.h.length>0&&("h"===D||"horizontal"===D||"universal"===D)){var a=t.fittingRules.h;for(s=0;s<a.length;s++){var c=a[s],u=c[0],p=c[1];if(i===u.charCodeAt(0)){for(var f,h,g=0;g<u.length;g++){var v=u.charAt(g),y=p.charAt(g),m=t.char[v.charCodeAt(0)],b=t.char[y.charCodeAt(0)];f=m[0].length,h=b[0].length;var w=parseInt((f-h)/2);if(r===m[0].substr(w,m[0].length).charAt(e)&&o===m[0].substr(w,m[0].length).charAt(e+2)){l=b[0].substr(w,b[0].length);break}r===m[0].substr(0,f-w).charAt(e)&&o===m[0].substr(0,f-w).charAt(e+2)&&(l=b[0].substr(0,f-w))}}l&&(n[e]=l[e],n[e+1]=l[e+1],C=!0)}}C||" "!==o&&" "===r||(n[e]=" ")))," "===n[e-1]&&" "===n[e]&&" "===n[e+1]&&r>0&&r<O-1&&" "!==T.charAt(T.length-1)&&(n[e]="")}),2===t.hLayout?function(){for(var e=0;e<n.length;e++)" "===n[e]&&e<n.length-1&&" "===n[e+1]&&n.splice(e,1)}():3===t.hLayout?function(){for(var e=0;e<n.length;e++)" "===n[e]&&e<n.length-1&&" "===n[e+1]&&n.splice(e,1)}():4===t.hLayout?function(){var e,t,l,r,o=[];for(e=0;e<n.length;e++)o.push(!0);for(t=0;t<n.length;t++)if(" "!==n[t]){for(l=t-1;l>=0&&" "!==n[l];l--);for(r=t+1;r<n.length&&" "!==n[r];r++);var i=r-l-1,a=parseInt(i/2);for(e=l+1;e<r;e++)e-l-1>a&&(o[e]=!1)}var d=[];for(e=0;e<n.length;e++)o[e]&&d.push(n[e]);n=d}():5===t.hLayout&&function(){var e,t,l,r,o=[];for(e=0;e<n.length;e++)o.push(!0);for(t=0;t<n.length;t++)if(" "!==n[t]){for(l=t-1;l>=0&&n[l]!==A;l--);for(r=t+1;r<n.length&&n[r]!==A;r++);var i=t-l-1;for(e=l+1;e<r;e++)e-l-1>=i&&(o[e]=!1)}var d=[];for(e=0;e<n.length;e++)o[e]&&d.push(n[e]);n=d}(),n=n.join("").replace(new RegExp(" ","g"),A),T+=n}}if(F=""+T,"v"!==D&&"vertical"!==D&&"universal"!==D||(T="",h=F.split("\n"),b>0&&(T=function(e,t,l){for(var n,r,o,i,a,d,s,c,u,p,f,h,g,v,y="",m="",b=0,w=0,S=Math.abs(l.height),k=[],_,x=0;x<e.length;x++)e[x].length>w&&(w=e[x].length);for(n=0;n<e.length;n++)for(e[n].length<w&&(e[n]+=Array(w-e[n].length).join(l.hardblank)),m="",r=0;r<w;r++)m+=e[n][r];y+=m;for(r=0;r<w;r++)for(b=0,k=[],n=0;n<S;n++)b+=k[n]=e[n].length;var C=parseInt(t/2);for(o=0;o<t-1;o++)for(n=0;n<e.length;n++)e[n][C]!==l.hardblank&&e[n][C+o]===l.hardblank&&e[n][C+o+1]!==l.hardblank&&(e[n]=e[n].substr(0,C+o)+e[n].substr(C+o+1,e[n].length));for(n=0;n<e.length;n++){for(var F,A,O,N=0;N<l.vLayout-1;N++)e[n]=e[n].replace(new RegExp("\\"+l.endChar,"g"),"");if(1===l.vLayout){var T=[];for(a=0;a<e[n].length;a++)T.push(e[n].charAt(a));e[n]=T}if(l.vLayout>1&&r>0&&r<w-1){var D,z,M,P=_(e[n]);for(a=0;a<e.length;a++){for(d=0;d<S-1;d++)" "!==e[d][a]&&" "!==e[d+1][a]&&(v=e[d][a].charCodeAt(0)+e[d+1][a].charCodeAt(0),g=String.fromCharCode(v));g&&(e[d][a]=" ",e[d+1][a]=g)}g=null}var L=_(e[n]);if(4===l.vLayout){F=[];for(a=0;a<e[n].length;a++)F.push(!0);for(i=0;i<e[n].length;i++)if(" "!==e[n][i]){for(O=i-1;O>=0&&" "!==e[n][O];O--);for(A=i+1;A<e[n].length&&" "!==e[n][A];A++);var E=A-O-1,U=parseInt(E/2);for(a=O+1;a<A;a++)a-O-1>U&&(F[a]=!1)}var j=[];for(a=0;a<e[n].length;a++)F[a]&&j.push(e[n][a]);e[n]=j}}for(n=0;n<e.length;n++)e[n]=e[n].join("").replace(new RegExp(" ","g"),l.hardblank);return e.join("\n")}(h,b,t))),l)l(F)}function o(e){return e.replace(/flf2a/,"").replace(/aFIGv1/,"").replace(/aFIGv2/,"")}function i(e){if(e)return e.split("\n")}function d(e){vart,n,r,o,a;if(!e)return;for(t=e[0].split(" "),n=1;n<t.length;n++)" "===t[n]||""===t[n]?t.splice(n,1):t[n]=parseInt(t[n],10);vari=l[t[0]]={hardblank:t[0].substr(5,1),height:t[1],baseline:t[2],maxLength:t[3],oldLayout:t[4],cmtLines:t[5],printDir:t[6],fullLayout:t[7],codetagCount:t[8],hLayout:t[4],vLayout:t[7],fittingRules:{h:[],v:[]}};for(o=1;o<=i.cmtLines;o++)e.splice(1,1);for(e[0]=t,n=1;n<e.length;n++)if(e[n]&&""!==e[n]){var d,s=e[n].length-1;s>=0&&(d=e[n].charAt(s),"@"===d&&s>0&&(d=e[n].charAt(s-1)),"@"!==d&&"#"!==d&&"$"!==d&&e[n]+=" ");varc,u=e[n].split("@");c=u.length-2;for(varp=0;p<c;p++)u[p]+="@";varf="";for(a=0;a<u.length-1;a++)f+=u[a];varh=i.char;if(f.indexOf("0x")>=0||f.indexOf("0X")>=0){varg=f.replace(/ /g,"").split("0x");f=parseInt(g[1],16)}else if(f.match(/^[0-9]+$/))f=parseInt(f,10);else if(f.match(/^-{0,1}[0-9]+$/))f=parseInt(f,10);else{varv=0,y=0;for(a=0;a<f.length;a++)" "===f.charAt(a)?y++:v=a;v<f.length-1&&f.length-1===y+v&&(f=f.substr(0,v+1))}if(h[f])for(r=0;r<h[f].length;r++)h[f][r]+=u[u.length-1];else h[f]=u.slice(u.length-1)}for(var m in i.char)i.char[m].splice(0,1);return i}function s(e){var t;if(e){t=d(i(o(e)));var n,r,s,c,u=Math.abs(t.height),p=t.maxLength,f=0,h=0;for(var g in t.char){varv=t.char[g];f=0;for(var y=0;y<v.length;y++)f=Math.max(f,v[y].length);for(y=0;y<v.length;y++)v[y]+=Array(f-v[y].length+1).join(" ");if(h=Math.max(h,f),n=t.hLayout,void 0===n||""===n||isNaN(n)||(n*=1)<=0)for(y=0;y<v.length;y++){var m,b,w,S,k;m=v[y],b=m.length;var _=t.hardblank,x=[],C={left:0,right:b-1};for(c=0;c<b;c++)m.charAt(c)===_||x.push(c);for(var F,A in x){F=x[A],w=m.charAt(F-1),S=m.charAt(F+1);var O=F-C.left+1,N=C.right-C.left+1;F===C.left?C.left++:F===C.right?C.right--:O/N<=.5?C.left=F:C.left=C.left}if(t.hLayout){for(c=0;c<v.length;c++)k=v[c],v[c]=k.substring(C.left,C.right+1)}else t.hLayout=0}for(var T in t.char){var D=t.char[T];if(n=t.hLayout,void 0===n||""===n||isNaN(n)||(n*=1)<=0)for(y=0;y<D.length;y++){var z;z=D[y],t.hLayout=0}}var M=t.char;for(var P in M){var L=M[P];if(s=t.vLayout,void 0===s||""===s||isNaN(s)||(s*=1)<=0){for(var E=0,U=0,j=u-1,q=-1,B=0,V=0;V<p;V++){var G=!1;for(y=0;y<u;y++){var H=L[y].charAt(V);if(H!==L[y].charAt(0)){G=!0;break}}G||(E=V+1),G&&-1===q&&(q=V)}for(V=p-1;V>=0;V--){var I=!1;for(y=0;y<u;y++){var W=L[y].charAt(V);if(W!==L[y].charAt(0)){I=!0;break}}I||(j=V-1)}t.vLayout=0}if(r=t.printDir,void 0===r||""===r||isNaN(r)||(r*=1)<=0)if(r=t.fullLayout,void 0===r||""===r||isNaN(r)||(r*=1)<=0)t.printDir=0,t.fullLayout=0;else for(var Z in t.printDir=0,t.char){var K,Q=0,Y=t.char[Z],X=Math.abs(t.height);for(y=0;y<X;y++)for(var J=0;J<Y[y].length;J++){var $=t.char[Z][y].charAt(J);if(" "!==$){K=!0;break}}K||Q++}var ee=t.fullLayout;if(void 0===ee||""===ee||isNaN(ee)||(ee*=1)<=0)t.fullLayout=null;else{var te=0,le=0,ne=ee;ne>=64?te=1:ne>=32?le=1:ne>=8&&(te=1,le=1),ne%2==1&&(t.hLayout=5),ne%4>=2&&(t.hLayout=4),ne%8>=4&&(t.hLayout=3),ne%32>=16&&(t.hLayout=2),t.vLayout=le?5:t.vLayout,t.vLayout=te?4:t.vLayout}}}return t}function c(e){if(!e)return;for(var n in l)if(n.toUpperCase()===e.toUpperCase()){e=n;break}return l[e]}function u(e,t,l,n){"undefined"!=typeof XMLHttpRequest?function(e,t,l){varn=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4==this.readyState&&200==this.status?t(null,this.responseText):4==this.readyState&&t(this.status)},n.send()}(e,function(e,r){e?l(e):t(null,r)}):"undefined"!=typeof require?function(e,t,l,n){varr,o=require("fs"),i=require("path");e=i.join(t,e),o.readFile(e,"utf-8",function(e,t){l(e,t)})}(e,t,function(e,t){l(e,t)}):l("Neither XHR nor FS is available.")}function p(e,t){varl,n;for(n in l=JSON.parse(JSON.stringify(e)),t)l[n]=t[n];return l}function f(e,t){t&&("function"==typeof setImmediate?setImmediate(function(){t(e,n)}):setTimeout(function(){t(e,n)},0))}var h,g,v;function y(e,t,l){n=l||n,a(e,t,function(e,t){n(null,t)})}function m(e,t,l){return"function"==typeof t&&(l=t,t=null),"function"==typeof l?void r(e,t,l):new Promise(function(n,o){r(e,t,function(e,t){e?o(e):n(t)})})}g=l,v=c,h=s,m.text=y,m.textSync=function(e,t){varl,n;if(l=v(n="Standard"),t&&"string"==typeof t&&(l=v(n=t)),t&&"object"==typeof t&&(n=t.font||n,l=v(n)),!l)throw new Error("Font not found");return t="object"!=typeof t?{}:t,t.font=n,o=e,i=p(l,t),a(o,i,null);var o,i},m.fonts=function(e){var t=[];for(var n in g)t.push(n);return"function"==typeof e?void f({},function(){e(null,t)}):new Promise(function(e){f({},function(){e(t)})})},m.fontsSync=function(){var e=[];for(var t in g)e.push(t);return e},m.loadFont=function(e,n){return"function"==typeof n?void u(t+"/"+e+".flf",null,function(t,l){return t?n(t):void n(null,h(l))}):new Promise(function(l,r){u(t+"/"+e+".flf",null,function(e,t){e?r(e):l(h(t))})})},m.loadFontSync=function(e){if("undefined"==typeof require){throw new Error("loadFontSync is only supported in Node.js.")}var n=require("fs"),r=require("path"),o=t+"/"+e+".flf";return h(n.readFileSync(r.join(__dirname,o),"utf-8"))},m.parseFont=function(e,t){g[e]=h(t)},m.fetchFont=u,m.figlet=m,e.default=m,e.text=y,e.textSync=m.textSync,e.fonts=m.fonts,e.fontsSync=m.fontsSync,e.loadFont=m.loadFont,e.loadFontSync=m.loadFontSync,e.parseFont=m.parseFont,e.fetchFont=u,Object.defineProperty(e,"__esModule",{value:!0})});
  </script>

  <!-- This is our application's own JavaScript. It runs AFTER the library above is ready. -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DOM Elements ---
        const textInput = document.getElementById('text-input');
        const fontSelector = document.getElementById('font-selector');
        const generateTextBtn = document.getElementById('generate-text-btn');
        const imageInput = document.getElementById('image-input');
        const generateImageBtn = document.getElementById('generate-image-btn');
        const outputElement = document.getElementById('ascii-output');
        const copyBtn = document.getElementById('copy-btn');
        
        // --- FONT POPULATION (INSTANTLY AVAILABLE) ---
        const populateFonts = () => {
            // This list is based on fonts known to be included in the self-contained library.
            const fonts = [
                'Standard', 'Big', 'Slant', 'Small', 'Script', 'Shadow', '3-D', '5 Line Oblique', 'Acrobatic', 'Alligator', 
                'Banner', 'Bell', 'Bigfig', 'Block', 'Bloody', 'Bolger', 'Braced', 'Bright', 'Calvin S', 'Catwalk', 
                'Chunky', 'Coinstak', 'Contessa', 'Crawford', 'Doh', 'Doom', 'Dot Matrix', 'Dr Pepper', 'Efti Font', 
                'Epic', 'Fender', 'Fire Font-k', 'Ghost', 'Goofy', 'Graceful', 'Graffiti', 'Impossible', 'Isometric1', 
                'Larry 3D', 'LCD', 'Merlin1', 'Modular', 'Nancyj', 'Ogre', 'Pawp', 'Rectangles', 'Roman', 'Speed', 'Star Wars', 
                'Stop', 'Sub-Zero', 'Swamp Land', 'Sweet', 'Tombstone', 'Train', 'Twisted'
            ];
            fontSelector.innerHTML = '';
            fonts.forEach(font => {
                const option = document.createElement('option');
                option.value = font;
                option.textContent = font;
                fontSelector.appendChild(option);
            });
        };

        // --- CORE FUNCTIONALITY ---
        const handleGenerateText = () => {
            const text = textInput.value;
            const font = fontSelector.value;
            if (!text) {
                alert("Please enter some text!");
                return;
            }
            
            // This is the direct, error-proof call to the embedded figlet library.
            figlet.text(text, { font: font }, (err, data) => {
                if (err) {
                    console.dir(err);
                    outputElement.textContent = 'An unexpected error occurred. The selected font may be corrupted in the library.';
                    copyBtn.disabled = true;
                    return;
                }
                outputElement.textContent = data;
                copyBtn.disabled = !data;
            });
        };
        
        const handleGenerateImage = () => {
            if (imageInput.files.length === 0) {
                alert("Please upload an image first!");
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement("canvas");
                    const ctx = canvas.getContext("2d");
                    const asciiChars = ['@', '#', 'S', '%', '?', '*', '+', ';', ':', ',', '.'];
                    const MAX_WIDTH = 120;
                    const scale = MAX_WIDTH / img.width;
                    canvas.width = MAX_WIDTH;
                    canvas.height = img.height * scale * 0.5;
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    let ascii = "";
                    for (let y = 0; y < canvas.height; y++) {
                        for (let x = 0; x < canvas.width; x++) {
                            const offset = (y * canvas.width + x) * 4;
                            const brightness = (0.299*imageData.data[offset] + 0.587*imageData.data[offset+1] + 0.114*imageData.data[offset+2]) / 255;
                            const charIndex = asciiChars.length - 1 - Math.floor(brightness * (asciiChars.length - 1));
                            ascii += asciiChars[charIndex];
                        }
                        ascii += "\n";
                    }
                    outputElement.textContent = ascii;
                    copyBtn.disabled = !ascii;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(imageInput.files[0]);
        };
        
        const handleCopy = () => {
            if (navigator.clipboard && outputElement.textContent) {
                navigator.clipboard.writeText(outputElement.textContent).then(() => {
                    copyBtn.textContent = 'Copied!';
                    setTimeout(() => { copyBtn.textContent = 'Copy to Clipboard'; }, 2000);
                });
            }
        };

        // --- Event Listeners & Initial Load ---
        generateTextBtn.addEventListener('click', handleGenerateText);
        generateImageBtn.addEventListener('click', handleGenerateImage);
        copyBtn.addEventListener('click', handleCopy);

        // Populate the fonts instantly on page load.
        populateFonts();
        outputElement.textContent = 'Your art will appear here...';
    });
  </script>

</body>
</html>
